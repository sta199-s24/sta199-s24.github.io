{
  "hash": "d1720f33da030da9a81aee6acbfe7b0a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"AE 10: Modelling fish\"\nsubtitle: \"Suggested answers\"\ncategories: \n  - Application exercise\n  - Answers\nfig-width: 7\nfig-asp: 0.618\n---\n\n\n::: callout-important\nThese are suggested answers.\nThis document should be used as reference only, it's not designed to be an exhaustive key.\n:::\n\nFor this application exercise, we will work with data on fish.\nThe dataset we will use, called `fish`, is on two common fish species in fish market sales.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\n\nfish <- read_csv(\"data/fish.csv\")\n```\n:::\n\n\nThe data dictionary is below:\n\n| **variable**      | **description**        |\n|-------------------|------------------------|\n| `species`         | Species name of fish   |\n| `weight`          | Weight, in grams       |\n| `length_vertical` | Vertical length, in cm |\n| `length_diagonal` | Diagonal length, in cm |\n| `length_cross`    | Cross length, in cm    |\n| `height`          | Height, in cm          |\n| `width`           | Diagonal width, in cm  |\n\n# Visualizing the model\n\nWe're going to investigate the relationship between the weights and heights of fish.\n\n-   **Demo:** Create an appropriate plot to investigate this relationship. Add appropriate labels to the plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(fish, aes(x = height, y = weight)) +\n  geom_point() +\n  labs(\n    title = \"Weights vs. heights of fish\",\n    x = \"Height (cm)\",\n    y = \"Weight (gr)\"\n  )\n```\n\n::: {.cell-output-display}\n![](ae-10-modeling-fish-A_files/figure-html/plot-hw-1.png){width=672}\n:::\n:::\n\n\n-   **Your turn (5 minutes):**\n\n    -   If you were to draw a a straight line to best represent the relationship between the heights and weights of fish, where would it go?\n        Why?\n\n        *Start from the bottom and go up Identify the first and last point and draw a line through most the others.*\n\n    -   Now, let R draw the line for you.\n        Refer to the documentation at <https://ggplot2.tidyverse.org/reference/geom_smooth.html>.\n        Specifically, refer to the `method` section.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    ggplot(fish, aes(x = height, y = weight)) +\n      geom_point() +\n      geom_smooth(method = \"lm\") +\n      labs(\n        title = \"Weights vs. lengths of fish\",\n        x = \"Head-to-tail lentgh (cm)\",\n        y = \"Weight of fish (grams)\"\n      )\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    \n    ```\n    `geom_smooth()` using formula = 'y ~ x'\n    ```\n    \n    \n    :::\n    \n    ::: {.cell-output-display}\n    ![](ae-10-modeling-fish-A_files/figure-html/plot-hw-lm-1.png){width=672}\n    :::\n    :::\n\n\n    -   What types of questions can this plot help answer?\n\n        *Is there a relationship between fish heights and weights of fish?*\n\n-   ***Your turn (3 minutes):***\n\n    -   We can use this line to make predictions.\n        Predict what you think the weight of a fish would be with a height of 10 cm, 15 cm, and 20 cm.\n        Which prediction is considered extrapolation?\n\n        *At 10 cm, we estimate a weight of 375 grams. At 15 cm, we estimate a weight of 600 grams At 20 cm, we estimate a weight of 975 grams. 20 cm would be considered extrapolation.*\n\n    -   What is a residual?\n\n        *Difference between predicted and observed.*\n\n# Model fitting\n\n-   **Demo:** Fit a model to predict fish weights from their heights.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfish_hw_fit <- linear_reg() |>\n  fit(weight ~ height, data = fish)\n\nfish_hw_fit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nparsnip model object\n\n\nCall:\nstats::lm(formula = weight ~ height, data = data)\n\nCoefficients:\n(Intercept)       height  \n    -288.42        60.92  \n```\n\n\n:::\n:::\n\n\n-   **Your turn (3 minutes):** Predict what the weight of a fish would be with a height of 10 cm, 15 cm, and 20 cm using this model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- c(10, 15, 20)\n-288 + 60.92 * x\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 321.2 625.8 930.4\n```\n\n\n:::\n:::\n\n\n-   **Demo:** Calculate predicted weights for all fish in the data and visualize the residuals under this model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfish_hw_aug <- augment(fish_hw_fit, new_data = fish)\n\nggplot(fish_hw_aug, aes(x = height, y = weight)) + \n  geom_point() + \n  geom_smooth(method = \"lm\", se = FALSE, color = \"lightgrey\") +  \n  geom_segment(aes(xend = height, yend = .pred), color = \"gray\") +  \n  geom_point(aes(y = .pred), shape = \"circle open\") + \n  theme_minimal() +\n  labs(\n    title = \"Weights vs. heights of fish\",\n    subtitle = \"Residuals\",\n    x = \"Height (cm)\",\n    y = \"Weight (gr)\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ae-10-modeling-fish-A_files/figure-html/residuals-1.png){width=672}\n:::\n:::\n\n\n# Model summary\n\n-   **Demo:** Display the model summary including estimates for the slope and intercept along with measurements of uncertainty around them. Show how you can extract these values from the model output.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfish_hw_tidy <- tidy(fish_hw_fit)\nfish_hw_tidy\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)   -288.      34.0      -8.49 1.83e-11\n2 height          60.9      2.64     23.1  2.40e-29\n```\n\n\n:::\n:::\n\n\n-   **Demo:** Write out your model using mathematical notation.\n\n$\\widehat{weight} = -288 + 60.9 \\times height$\n\n# Correlation\n\nWe can also assess correlation between two quantitative variables.\n\n-   **Your turn (5 minutes):**\n    -   What is correlation?\n        What are values correlation can take?\n\n        *Strength and direction of a linear relationship. It's bounded by -1 and 1.*\n\n    -   Are you good at guessing correlation?\n        Give it a try!\n        <https://www.rossmanchance.com/applets/2021/guesscorrelation/GuessCorrelation.html>\n-   **Demo:** What is the correlation between heights and weights of fish?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfish |>\n  summarize(r = cor(height, weight))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 1\n      r\n  <dbl>\n1 0.954\n```\n\n\n:::\n:::\n\n\n# Adding a third variable\n\n-   **Demo:** Does the relationship between heights and weights of fish change if we take into consideration species? Plot two separate straight lines for the Bream and Roach species.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(fish, \n       aes(x = height, y = weight, color = species)) +\n  geom_point() +\n  geom_smooth(method = \"lm\") +\n  labs(\n    title = \"Weights vs. heights of fish\",\n    x = \"Height (cm)\",\n    y = \"Weight (gr)\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ae-10-modeling-fish-A_files/figure-html/plot-hws-lm-1.png){width=672}\n:::\n:::\n\n\n# Fitting other models\n\n-   **Demo:** We can fit more models than just a straight line. Change the following code below to read `method = \"loess\"`. What is different from the plot created before?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(fish, \n       aes(x = height, y = weight)) +\n  geom_point() +\n  geom_smooth(method = \"lm\") +\n  labs(\n    title = \"Weights vs. heights of fish\",\n    x = \"Height (cm)\",\n    y = \"Weight (gr)\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ae-10-modeling-fish-A_files/figure-html/plot-hw-loess-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "ae-10-modeling-fish-A_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}